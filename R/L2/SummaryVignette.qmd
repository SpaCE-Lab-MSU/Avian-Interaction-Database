---
title: "Summary Vignette"
format: html
editor: visual
---

# Interaction Data Summary Statistics

```{r, warnings=FALSE}

library(dplyr)

df <- read.csv(here::here("../Avian-Interaction-Database-Working/L1/ain_cac.csv"))

num_intxns <- nrow(df)

unique_intxns <- df %>% 
  dplyr::select(species1_scientific, 
                species2_scientific, 
                effect_sp1_on_sp2, 
                effect_sp2_on_sp1, 
                interaction) %>% 
  filter(!duplicated(.)) 

num_unique_intxns <- nrow(unique_intxns)

num_focal_spp <- length(unique(df$species1_scientific))

unique_spp_list <- unique(c(df$species1_scientific, df$species2_scientific))
num_total_spp <- length(unique_spp_list)

num_new_spp2 <- length(setdiff(unique_spp_list, df$species1_scientific))

```

-   Number of documented pairwise interactions: `r num_intxns`
-   Number of unique pairwise interactions: `r num_unique_intxns`
-   Number of focal species: `r num_focal_spp`
-   Number of additional non-focal spp: `r num_new_spp2`
-   Number of species (total): `r num_total_spp`
-   Percent of world's bird spp (out of 11,1145 spp): `r round(num_total_spp/11145*100, 2)`
-   Total number of migratory species: \[Not sure how to calculate this\]
-   Total number of interaction types: `r length(unique(df$interaction))`

```{r}

unique_intxns %>% group_by(interaction) %>% summarize(n=n()) %>% arrange(-n)
```

# Interaction Data Exploratory Figures

### Interaction Distribution Figure

```{r}
#| echo: true
#| results: hide
#| message: false
#| warning: false
#| fig-show: hide

source(here::here("../Avian-Interaction-Database/R/L2/DistributionFigure.R"))
```

```{r, fig.width=14, out.width="100%"}
int_NA_plot <- int_dist(inter_NA)
int_NA_plot
```

### Interaction Phylogeny Figure

```{r}
#| echo: true
#| results: hide
#| message: false
#| warning: false
#| fig-show: hide

source(here::here("../Avian-Interaction-Database/R/L2/PhylogenyFigure.R"))
```

```{r, fig.width=16, fig.height=8, out.width="100%"}
#| warning: false

phyloplot_species <- plot_phylo_combined(
  tree = NA_tree,
  data = inter_NA_working,
  species_col = "species",
  family_col = "family",
  value_col = "n_int",
  layout = "circular",
  branch_colors = c("#440154FF", "#414487FF", "#2A788EFF", "#22A884FF", "#7AD151FF", "#FDE725FF"),
  breaks = c(min(inter_NA_working$n_int, na.rm = TRUE), 5, 25, 100,
             max(inter_NA_working$n_int, na.rm = TRUE)),
  label_offset = 8,
  label_size = 4.5,
  tip_size = 2,
  min_species = 25,
  family_palette = family_palette_master,  # Use master palette
  title = "",
  legend_title = "Number of interactions"
)
phyloplot_species
```

### Interaction Network Figure

```{r}
#| echo: true
#| results: hide
#| message: false
#| warning: false
#| fig-show: hide

source(here::here("../Avian-Interaction-Database/R/L2/NetworkFigure.R"))
```

```{r, fig.width=14, fig.height=6, out.width="100%"}
oaktit <- create_network(inter_NA_only_int, "Baeolophus inornatus", curve_edges = T, show_labels = F)
oaktit

```

```{r, fig.width=14, fig.height=6, out.width="100%"}
plot <- create_combined_network(inter_NA_only_int, c("Baeolophus inornatus", "Dryobates nuttallii", "Glaucidium gnoma"), show_labels = F, curve_edges = T)
plot
```
